---
title: 'Jotaiì •ë¦¬'
date: '2023-11-07'
tags: ['Frontend']
draft: false
summary: 'Jotaiì— ëŒ€í•´ ê°„ë‹¨íˆ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤'
images: []
---

ğŸ¦¡ ì‘ì„±ì : í˜œì›

í”„ë¡œì íŠ¸ ìƒíƒœ ê´€ë¦¬ ë„êµ¬ë¡œ Jotaië¥¼ ë„ì…í•˜ê¸°ë¡œ í–ˆë‹¤! ê·¸ëƒ¥ Context apië¡œ ê´€ë¦¬í• ê¹Œ Zustandë¥¼ ì“¸ê¹Œ ê³ ë¯¼ì„ ë§ì´ í•˜ë‹¤ê°€ Next.jsì— ì¢€ ë” ì í•©í•œ íˆ´ì„ ì‚¬ìš©í•´ ë³´ê¸°ë¡œ í–ˆë‹¤. ì´ ê²Œì‹œê¸€ì€ Jotai ê³µì‹ë¬¸ì„œ ì²« í˜ì´ì§€ì— ë‚˜ì™€ ìˆëŠ” í•µì‹¬ ë‚´ìš©ë§Œ ê°„ì¶”ë ¤ì„œ ì •ë¦¬í•œ ê¸€ì´ë‹¤ğŸ«¡

JotaiëŠ” React ì „ì—­ ìƒíƒœ ê´€ë¦¬ì— atomicí•˜ê²Œ ì ‘ê·¼í•˜ëŠ” ë°©ë²•ì„ ì·¨í•œë‹¤.

atomsì™€ rendersë¥¼ ê²°í•©í•œ build stateëŠ” atom dependencyì— ë”°ë¼ ìë™ìœ¼ë¡œ ìµœì í™”ë¨
ì´ê²ƒì€ React contextì˜ ì¶”ê°€ì ì¸ ë¦¬ë Œë” ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ , memoizationí•  í•„ìš”ë¥¼ ì—†ì• ê³ , ì„ ì–¸ì  í”„ë¡œê·¸ë˜ë° ëª¨ë¸ì„ ìœ ì§€í•˜ë©´ì„œ signalì— ëŒ€í•´ ìœ ì‚¬í•œ ê°œë°œì ê²½í—˜ì„ ì œê³µ

```bash
Installation
// npm
npm i jotai
npmì—ì„œëŠ” ìœ„ì™€ ê°™ì´ ì„¤ì¹˜í•œë‹¤.
Configuration
Next.js (SWC)

// npm
npm install --save-dev @swc-jotai/react-refresh
```

```js
// next.config.js
experimental: {
swcPlugins: [['@swc-jotai/react-refresh', {}]],
}
```

ìš°ë¦¬ í”„ë¡œì íŠ¸ì—ì„œëŠ” Next.js, swcë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì€ ì„¤ì •ì´ í•„ìš”í•˜ë‹¤. Babelì´ë‚˜ Gatsby ë“±ì˜ ì„¤ì •ì€ ê³µì‹ë¬¸ì„œì— ë” ìì„¸íˆ ë‚˜ì™€ ìˆë‹¤.

Create atoms
Primitive atoms

primitive atomì€ booleans, numbers, strings, objects, arrays, sets, maps ë“± ì–´ë–¤ íƒ€ì…ë„ ê°€ëŠ¥

```ts
import { atom } from 'jotai'

const countAtom = atom(0)

const countryAtom = atom('Japan')

const citiesAtom = atom(['Tokyo', 'Kyoto', 'Osaka'])

const animeAtom = atom([
  {
    title: 'Ghost in the Shell',
    year: 1995,
    watched: true,
  },
  {
    title: 'Serial Experiments Lain',
    year: 1998,
    watched: false,
  },
])
```

Jotaiì—ì„œ atomì„ importí•´ ì™€ì„œ ìƒì„±í•¨
Derived atoms

derived atomì€ ìì‹ ì˜ ê°’ì„ ë¦¬í„´í•˜ê¸° ì „ì—, ë‹¤ë¥¸ atomsì—ê²Œì„œ ì½ì–´ì˜¬ ìˆ˜ ìˆìŒ

```ts
const progressAtom = atom((get) => {
  const anime = get(animeAtom)
  return anime.filter((item) => item.watched).length / anime.length
})
```

getì„ ì‚¬ìš©í•˜ë©´ ë‹¤ë¥¸ atomì—ê²Œì„œ ê°’ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ”ë“¯
progressAtomì´ derived atom
Use atoms
React components ì•ˆì—ì„œ stateë¥¼ ì½ê±°ë‚˜ ì“°ê¸° ìœ„í•´ atomsë¥¼ ì‚¬ìš©

Read and write from same component

atomsê°€ ê°™ì€ ì»´í¬ë„ŒíŠ¸ ì•ˆì—ì„œ ì½ê³  ì“°ì—¬ì§ˆ ë•Œ, ê²°í•©ëœ useAtom hookì„ ì‚¬ìš©í•˜ì!

```tsx
import { useAtom } from 'jotai'

const AnimeApp = () => {
  const [anime, setAnime] = useAtom(animeAtom)

  return (
    <>
      <ul>
        {anime.map((item) => (
          <li key={item.title}>{item.title}</li>
        ))}
      </ul>
      <button
        onClick={() => {
          setAnime((anime) => [
            ...anime,
            {
              title: 'Cowboy Bebop',
              year: 1998,
              watched: false,
            },
          ])
        }}
      >
        Add Cowboy Bebop
      </button>
    </>
  )
}
```

useAtomì€ ê·¸ëƒ¥ ì „ì—­ ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” useState ëŠë‚Œ
ì½ê¸°&ì“°ê¸°ë¥¼ ë‹¤ í•  ë•ŒëŠ” useAtomì„ ì¨ë¼
Read and write from separate components

atom ê°’ë“¤ì´ ì½ê±°ë‚˜ ì“°ê¸°ë§Œ í•˜ëŠ” ê²½ìš°, ë¦¬ë Œë”ë§ì„ ìµœì í™”í•˜ê¸° ìœ„í•´ ë¶„ë¦¬ëœ useAtomValueì™€ useSetAtom hookì„ ì‚¬ìš©í•˜ì!

```tsx
import { useAtomValue, useSetAtom } from 'jotai'

const AnimeList = () => {
  const anime = useAtomValue(animeAtom)

  return (
    <ul>
      {anime.map((item) => (
        <li key={item.title}>{item.title}</li>
      ))}
    </ul>
  )
}

const AddAnime = () => {
  const setAnime = useSetAtom(animeAtom)

  return (
    <button
      onClick={() => {
        setAnime((anime) => [
          ...anime,
          {
            title: 'Cowboy Bebop',
            year: 1998,
            watched: false,
          },
        ])
      }}
    >
      Add Cowboy Bebop
    </button>
  )
}

const ProgressTracker = () => {
  const progress = useAtomValue(progressAtom)

  return <div>{Math.trunc(progress * 100)}% watched</div>
}

const AnimeApp = () => {
  return (
    <>
      <AnimeList />
      <AddAnime />
      <ProgressTracker />
    </>
  )
}
```

ì½ê¸°ë§Œ í•˜ëŠ” ê²½ìš°ì—ëŠ” useAtomValue()ë¥¼ ì‚¬ìš©í•˜ê³ , ì“°ê¸°ë§Œ í•˜ëŠ” ê²½ìš°ì—ëŠ” useSetAtom()ì„ ì‚¬ìš©í•˜ì
recoilì´ë‘ ë¹„ìŠ·í•¨ Server-side rendering ë§Œì•½ Next.jsë‚˜ Gatsby ê°™ì€ SSR í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•œë‹¤ë©´,
rootì—ì„œ ìµœì†Œí•œ í•˜ë‚˜ì˜ Provider componentë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤

```tsx
import { Provider } from 'jotai'

// Placement is framework-specific (see below)

<Provider>
  {...}
</Provider>
```

Next.js(app directory)ì˜ ê²½ìš°

ë¶„ë¦¬ëœ client ì»´í¬ë„ŒíŠ¸ ì•ˆì— provider ìƒì„±
root layout.js ì„œë²„ ì»´í¬ë„ŒíŠ¸ì—ì„œ í•´ë‹¹ provider import í•´ì„œ ê°ì‹¸ì£¼ê¸°
// providers.js (app directory)

```tsx
'use client'

import { Provider } from 'jotai'

export default function Providers({ children }) {
  return <Provider>{children}</Provider>
}

// layout.js (app directory)
import Providers from './providers'

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>
        <Providers>{children}</Providers>
      </body>
    </html>
  )
}
```

API overview

1. Core
   JotaiëŠ” ë§¤ìš° ìµœì†Œí™”ëœ APIë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©°, TypeScirpt ì¹œí™”ì 
   Reactì˜ useState hookë§Œí¼ ì‚¬ìš©ì´ ê°„ë‹¨í•˜ì§€ë§Œ, ëª¨ë“  stateëŠ” ì „ì—­ì ìœ¼ë¡œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê³ , íŒŒìƒëœ stateë¥¼ êµ¬í˜„í•˜ê¸° ì‰½ê³ , ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ì´ ìë™ìœ¼ë¡œ ì œê±°ë¨

2. Utilities
   Jotai íŒ¨í‚¤ì§€ì—ëŠ” ë˜í•œ jotai/utils ë²ˆë“¤ì´ í¬í•¨ë˜ì–´ ìˆë‹¤!!
   ì´ ì¶”ê°€ì ì¸ í•¨ìˆ˜ë“¤ì€ localStorageì—ì„œ atomì„ ìœ ì§€í•˜ê±°ë‚˜, SSR ì¤‘ì— atomì„ hydrateí•˜ê±°ë‚˜, Reduxì™€ ìœ ì‚¬í•œ reducerì™€ action typesë¥¼ atomì„ ìƒì„±í•˜ëŠ” ë“±ì— ëŒ€í•œ ì¶”ê°€ì ì¸ ì§€ì›ì„ í•´ ì¤Œ

```tsx
import { useAtom } from 'jotai'
import { atomWithStorage } from 'jotai/utils'

// Set the string key and the initial value
const darkModeAtom = atomWithStorage('darkMode', false)

const Page = () => {
  // Consume persisted state like any other atom
  const [darkMode, setDarkMode] = useAtom(darkModeAtom)
  const toggleDarkMode = () => setDarkMode(!darkMode)
  return (
    <>
      <h1>Welcome to {darkMode ? 'dark' : 'light'} mode!</h1>
      <button onClick={toggleDarkMode}>toggle theme</button>
    </>
  )
}
```

localStorageì— atomì„ ì„¸íŒ…í•˜ëŠ” ì˜ˆì œ

Integrations ê° ê³µì‹ integrationì„ ìœ„í•œ ë¶„ë¦¬ëœ íŒ¨í‚¤ì§€ë“¤ë„ ì¡´ì¬í•¨

tRPC, Immer, Query, XState, URQL, Optics, Relay, location, molecules, cache ë“±ë“± ëª‡ëª‡ integrationë“¤ì€ atomWithImmer(Immer)ë‚˜ atomWithMachine(XState)ì™€ ê°™ì€ ì“°ê¸° í•¨ìˆ˜ë¥¼ ê°–ì¶˜ ìƒˆë¡œìš´ atom
typesì„ ì œê³µí•˜ê¸°ë„ í•¨

ë‹¤ë¥¸ ê²ƒë“¤ì€ atomWithLocationì´ë‚˜ atomWithHashì™€ ê°™ì€ ì–‘ë°©í–¥ ë°ì´í„° ë°”ì¸ë”©ì„ ìœ„í•œ atom typesë¥¼ ì œê³µí•˜ê¸°ë„ í•¨

```tsx
import {useAtom} from 'jotai' import {atomWithImmer} from
'jotai-immer'

// Create a new atom with an immer-based write function
const countAtom = atomWithImmer(0)

const Counter = () => {
const [count] = useAtom(countAtom)
return (

<div>count: {count}</div>) }

const Controls = () => {
// setCount === update: (draft: Draft<Value>) => void
const [, setCount] = useAtom(countAtom)
const increment = () => setCount((c) => (c = c + 1))
return (

<button onClick={increment}>+1</button>) }
```

Immerì™€ ì‚¬ìš©ë˜ëŠ” integrationì¸ jotai-immerì— ëŒ€í•œ ì˜ˆì œ

âœ¨ ê¸°ë³¸ë§Œ ì •ë¦¬í•´ì„œ ê·¸ëŸ°ì§€ ì‚¬ìš©ë²•ì´ êµ‰ì¥íˆ ì‰¬ìš´ ê²ƒ ê°™ë‹¤ğŸ‘» ì•„ì§ Redux ë“± ë‹¤ë¥¸ ìƒíƒœê´€ë¦¬ ë„êµ¬ë§Œí¼ ë©”ì´ì €í•œ íˆ´ì´ ì•„ë‹ˆë¼ ê·¸ëŸ°ì§€ ë ˆí¼ê°€ ì ì–´ì„œ ê±±ì •í–ˆëŠ”ë°, ë³µì¡í•˜ì§€ë„ ì•Šê³  ê³µì‹ ë¬¸ì„œë„ ì˜ ë˜ì–´ ìˆì–´ì„œ ë‹¤í–‰ì´ë‹¤. Integrationì„ ì‚¬ìš©í•˜ì§„ ì•Šì„ ê²ƒ ê°™ê³  Core ìœ„ì£¼ë¡œ ì“°ë˜ ì¢…ì¢… Utilsë„ ì“°ëŠ” í˜•íƒœë¡œ ì‚¬ìš©í•  ê²ƒ ê°™ë‹¤. ë‹¤ìŒ í¬ìŠ¤íŠ¸ì—ì„œëŠ” Core ë‚´ìš©ì„ ìì„¸íˆ ì •ë¦¬í•˜ê³ , Utilsì—ì„œ ìœ ìš©í•  ê²ƒ ê°™ì€ ë©”ì†Œë“œ ìœ„ì£¼ë¡œ ì •ë¦¬í•´ ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤!
